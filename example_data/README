BreaKmer example data README
-------

To get started in running the example data, first make sure all the BreaKmer software dependencies are installed and running properly on your system. 

The follow files have been provided in the example_data directory to run the example data:
B2M.bam - sorted BAM file containing aligned reads to B2M.
B2M.bam.bai - index of B2M.bam file.
breakmer.cfg - BreaKmer config file.
cutadapt.cfg- Cutadapt configuration file containing the Illumina adapters to trim from sequences.
genes.bed - BED file specifying coordinates for B2M tiled regions.
ref_seq/B2M - all the extracted B2M reference sequences and associated kmer files.

The following files have been provided in the BreaKmer directory (one level up from example_data directory) to run the example data:
<path to BreaKmer directory>/bin/cutadapt-1.5.tar.gz - uncompress and use binary in bin directory
<path to BreaKmer directory>/bin/jellyfish-1.1.11.tar.gz - uncompress and follow installation instructions, binary should be in the bin directory after successfull install
<path to BreaKmer directory>/bin/blat - blat binary for linux x86 64bit
<path to BreaKmer directory>/bin/gfClient - blat server binary for linux x86 64bit
<path to BreaKmer directory>/bin/gfServer - blat server binary for linux x86 64bit
<path to BreaKmer directory>/ref/ucsc_hg19_refgene.txt
<path to BreaKmer directory>/ref/ucsc_hg19_rmsk.bed
<path to BreaKmer directory>/ref/ucsc_hg19_dna.chr15.fa

To analyze the example data follow these steps:

1. Edit the template configuration file appropriately (breakmer.cfg).
  - We have provided all the files necessary to run the example data. The configuration file paths need to be changed accordingly.

analysis_name=breakmer_test
targets_bed_file=<path to example_data directory>/genes.bed
sample_bam_file=<path to example_data directory>/B2M.bam
analysis_dir=<path to example_data directory>
reference_data_dir=<path to example_data directory>/ref_seq
cutadapt=<path to BreaKmer directory>/bin/cutadapt-1.5/bin/cutadapt
cutadapt_config_file=<path to example_data directory>/cutadapt.cfg
jellyfish=<path to BreaKmer directory>/bin/jellyfish-1.1.11/bin/jellyfish
blat=<path to BreaKmer directory>/bin/blat
gfclient=<path to BreaKmer directory>/bin/gfClient
gfserver=<path to BreaKmer directory>/bin/gfServer
fatotwobit=<path to BreaKmer directory>/bin/faToTwoBit
reference_fasta=<path to BreaKmer directory>/ref/ucsc_hg19_dna.chr15.fa
gene_annotation_file=<path to BreaKmer directory>/ref/ucsc_hg19_refgene.txt
repeat_mask_file=<path to BreaKmer directory>/ref/ucsc_hg19_rmsk.bed
kmer_size=15 

2. Run BreaKmer
  - python <path to BreaKmer directory>/breakmer.py <path to example directory>/breakmer.cfg

3. The output files will be within the designated analysis directory (i.e., example_data) as specified in the configuration file.

The output of the program should appear in the example_data/output and example_data/targets directories. The follow example files have been provided to check the users output and the expected output.

example_output/ - Directory containing the example output that should be expected with a successful run.
 example_summary.out - Example summary output file.
 example_indel_svs.out - Example indel output file.
 B2M/
   B2M_indel_svs.out - Example indel output file for B2M.
   contig1_reads.sorted.bam - Example BAM file containing extracted reads for detected indel event in B2M.
   contig1_svs.out - Example output file for SV event found in a contig.
   contig1_reads.bam - Unsorted extracted reads in BAM format.
   contig_reads.sorted.bam.bai - Index of sorted extracted reads BAM file.
example_targets/ - Directory containing the example targets output.
 B2M/
   data/
     B2M_sv_reads.bam - BAM formatted file with extracted reads from the defined B2M region.
     B2M_sv_reads.fastq - Fastq formatted file with the extracted reads from the defined B2M region.
     B2M_sv_reads.sorted.bam - Sorted BAM of extracted reads. 
     B2M_sv_reads.sorted.bam.bai - Index of the sorted BAM file.
     B2M_sv_reads_cleaned.fastq - Fastq formatted file containing the read sequences after they have been cleaned of adapter and low-quality sequence.
     B2M_sv_reads_cleaned_filtered.fastq - Cleaned reads that have been further filtered if the original soft-clipped sequences were removed.
     B2M_sv_sc_seqs.fa - Fasta formatted file containing the soft-clipped sequences.
     B2M_sv_reads_cleaned_filtered.fastq_15mers_counts_0 - Jellyfish intermediate output file for the 15mers generated from the filtered reads.
     B2M_sv_reads_cleaned_filtered.fastq_15mers_dump_0 - Jellyfish final output file of the 15mers generated from the filtered reads.
     B2M_sv_sc_seqs.fa_15mers_counts_0 - Jellyfish intermediate output file for the 15mers generated from the unaligned sequences from the extracted reads.
     B2M_sv_sc_seqs.fa_15mers_dump_0 - Jellyfish final output file of the 15mers generated from the unaligned sequences from the extracted reads.
   contigs/
     contig/
       blat_res_target.psl - Raw BLAT output from re-aligning the contig to the target region reference sequence.
       blat_res_target.psl.mod - Modified BLAT output with the correct genomic chromosome and coordinates from hit.
       contig1.fa - Fast formatted file containing contig1 consensus sequence.
       contig1.fq - Fastq formatted file containing the read sequences used for assemblying contig1.
       contig1_svs.out - The SV formatted output for contig1.
   kmers/
     B2M_sample_kmers.out - Sample only 15-mers with number of reads in which they are found.
     B2M_sample_kmers_merged.out - The 15-mers and the IDs of the reads used to assemble contigs.
